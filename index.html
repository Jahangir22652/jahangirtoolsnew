<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Jahangir Tools Login</title>

<!-- Import Poppins font -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />

<style>
  body {
    margin: 0; 
    font-family: 'Poppins', sans-serif;
    font-weight: 400;
    background: #000814;
    color: #00bfff;
    display: flex; 
    justify-content: center; 
    align-items: center;
    min-height: 100vh; 
    flex-direction: column;
    text-shadow: 0 0 6px #00bfff88;
  }

  #loginDiv {
    background: #001f4d;
    padding: 30px;
    border-radius: 12px;
    box-shadow: 0 0 20px #00bfffcc, inset 0 0 12px #0099eecc;
    width: 360px;
    text-align: center;
    display: none;
  }

  #adminDiv {
    background: #001f4d;
    padding: 20px 25px; /* Reduced padding for smaller admin panel */
    border-radius: 12px;
    box-shadow: 0 0 20px #00bfffcc, inset 0 0 12px #0099eecc;
    width: 360px;
    text-align: center;
    display: none;
  }

  input, button {
    width: 100%; 
    padding: 14px; 
    margin: 10px 0;
    background: #003366; 
    border: 1px solid #00bfff;
    color: #00bfff; 
    border-radius: 6px; 
    font-size: 17px;
    font-family: 'Poppins', sans-serif;
    font-weight: 400;
    text-shadow: 0 0 5px #00bfff77;
    transition: background 0.3s, border-color 0.3s;
  }
  button {
    background: #00bfff; 
    border:none; 
    color:#001a33; 
    font-weight: 600; 
    cursor:pointer;
    box-shadow: 0 0 10px #00bfffcc;
  }
  button:hover {
    background: #0099dd;
    box-shadow: 0 0 15px #0099ddcc;
  }
  #logoutBtn, #logoutBtnUser {
    background: #cc3300;
    margin-top: 20px;
    box-shadow: 0 0 8px #cc3300cc;
  }
  #toolsList {
    margin-top: 20px; 
    max-height: 210px; 
    overflow-y: auto; 
    text-align: left;
    border-top: 1px solid #00bfff; 
    padding-top: 12px;
  }
  .toolItem {
    display: flex; 
    justify-content: space-between; 
    margin-bottom: 12px;
    background: #004080; 
    padding: 9px 14px; 
    border-radius: 7px;
    box-shadow: 0 0 9px #0099ddcc;
  }
  .toolLink {
    color: #00d0ff; 
    text-decoration: none; 
    font-weight: 600;
    text-shadow: 0 0 7px #00d0ffbb;
  }
  .deleteBtn {
    background: #cc3300; 
    border:none; 
    color:white; 
    padding: 7px 14px; 
    border-radius: 4px; 
    cursor: pointer;
    font-weight: 600;
    box-shadow: 0 0 7px #cc3300cc;
  }
  #message, #loginMessage, #addUserMessage {
    margin-top: 10px; 
    height: 22px; 
    font-weight: 600;
    text-shadow: 0 0 4px #00bfff88;
  }
  #usernameDisplay {
    font-size: 22px;
    font-weight: 600;
    margin: 22px 0;
    text-align: center;
    text-shadow: 0 0 8px #00bfffcc;
  }

  /* User Page Styling */
  #userDiv {
    display: none;
    width: 100%;
    max-width: 1000px;
    padding: 22px;
    text-align: center;
  }
  #userToolsList {
    display: flex;
    flex-wrap: wrap;
    gap: 18px;
    justify-content: center;
    padding: 12px;
    margin-top: 12px;
  }
  .userToolBtn {
    background: #004080;
    color: #00bfff;
    border: 1px solid #00bfff;
    border-radius: 10px;
    padding: 18px 30px;
    font-weight: 600;
    font-size: 18px;
    text-decoration: none;
    display: inline-block;
    white-space: nowrap;
    box-shadow: 0 0 15px #00bfffcc;
    transition: background 0.3s, box-shadow 0.3s;
  }
  .userToolBtn:hover {
    background: #007acc;
    box-shadow: 0 0 25px #00dfffcc, 0 0 35px #00dfffcc;
  }

  @media (max-width: 600px) {
    #userToolsList {
      flex-direction: column;
      align-items: center;
      overflow-x: unset;
    }
    .userToolBtn {
      width: 100%;
      max-width: 360px;
    }
  }
</style>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
</head>
<body>

<div id="loginDiv">
  <h2>Jahangir Tools Login</h2>
  <input type="email" id="email" placeholder="Email" />
  <input type="password" id="password" placeholder="Password" />
  <button id="loginBtn">Login</button>
  <div id="loginMessage"></div>
</div>

<div id="adminDiv">
  <h2>Admin Panel</h2>

  <h3>Add Tool</h3>
  <input type="text" id="toolName" placeholder="Tool Name" />
  <input type="text" id="toolLink" placeholder="Tool URL" />
  <button id="addToolBtn">Add Tool</button>
  <div id="message"></div>

  <div id="toolsList"></div>

  <hr style="border-color:#00bfff; margin: 20px 0;">

  <h3>Add User</h3>
  <input type="email" id="newUserEmail" placeholder="User Email" />
  <input type="password" id="newUserPassword" placeholder="User Password" />
  <button id="addUserBtn">Add User</button>
  <div id="addUserMessage"></div>

  <button id="logoutBtn">Logout</button>
</div>

<div id="userDiv">
  <h2>User Dashboard</h2>
  <div id="usernameDisplay">Welcome, User</div>
  <div id="userToolsList">Loading tools...</div>
  <button id="logoutBtnUser">Logout</button>
</div>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyAFrJLKxY3hSl9FeVpoK1EeB6_05Tr1uS0",
    authDomain: "jahangir-redeem.firebaseapp.com",
    databaseURL: "https://jahangir-redeem-default-rtdb.firebaseio.com",
    projectId: "jahangir-redeem",
    storageBucket: "jahangir-redeem.appspot.com",
    messagingSenderId: "794529772841",
    appId: "1:794529772841:web:88e03f816d651cd180b338",
    measurementId: "G-SPV3J3F32C"
  };

  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.firestore();

  const loginDiv = document.getElementById('loginDiv');
  const adminDiv = document.getElementById('adminDiv');
  const userDiv = document.getElementById('userDiv');
  const emailInput = document.getElementById('email');
  const passwordInput = document.getElementById('password');
  const loginBtn = document.getElementById('loginBtn');
  const loginMessage = document.getElementById('loginMessage');
  const toolNameInput = document.getElementById('toolName');
  const toolLinkInput = document.getElementById('toolLink');
  const addToolBtn = document.getElementById('addToolBtn');
  const messageDiv = document.getElementById('message');
  const toolsListDiv = document.getElementById('toolsList');
  const userToolsListDiv = document.getElementById('userToolsList');
  const logoutBtn = document.getElementById('logoutBtn');
  const logoutBtnUser = document.getElementById('logoutBtnUser');

  const newUserEmailInput = document.getElementById('newUserEmail');
  const newUserPasswordInput = document.getElementById('newUserPassword');
  const addUserBtn = document.getElementById('addUserBtn');
  const addUserMessage = document.getElementById('addUserMessage');

  const usernameDisplay = document.getElementById('usernameDisplay');

  // Show login page initially
  loginDiv.style.display = 'block';

  loginBtn.addEventListener('click', () => {
    const email = emailInput.value.trim();
    const password = passwordInput.value.trim();
    loginMessage.textContent = '';

    if (!email || !password) {
      loginMessage.style.color = '#cc3300';
      loginMessage.textContent = 'Please enter email and password.';
      return;
    }

    // Admin login check (hardcoded)
    if(email === 'admin@jahangir.com' && password === 'admin1234') {
      loginMessage.style.color = '#00bfff';
      loginMessage.textContent = 'Admin login successful.';
      showAdminPanel();
      return;
    }

    // Firebase user login
    auth.signInWithEmailAndPassword(email, password)
      .then(userCredential => {
        loginMessage.style.color = '#00bfff';
        loginMessage.textContent = 'User login successful.';
        showUserPanel(userCredential.user);
      })
      .catch(error => {
        loginMessage.style.color = '#cc3300';
        loginMessage.textContent = error.message;
      });
  });

  function showAdminPanel() {
    loginDiv.style.display = 'none';
    userDiv.style.display = 'none';
    adminDiv.style.display = 'block';
    loadToolsAdmin();
  }

  function showUserPanel(user) {
    loginDiv.style.display = 'none';
    adminDiv.style.display = 'none';
    userDiv.style.display = 'block';
    loadToolsUser();
    displayUsername(user.email);
  }

  addToolBtn.addEventListener('click', () => {
    const name = toolNameInput.value.trim();
    const link = toolLinkInput.value.trim();

    if(!name || !link){
      messageDiv.style.color = '#cc3300';
      messageDiv.textContent = 'Please enter tool name and URL.';
      return;
    }

    db.collection('tools').add({ name, link })
      .then(() => {
        messageDiv.style.color = '#00bfff';
        messageDiv.textContent = 'Tool added successfully!';
        toolNameInput.value = '';
        toolLinkInput.value = '';
        loadToolsAdmin();
      })
      .catch(error => {
        messageDiv.style.color = '#cc3300';
        messageDiv.textContent = error.message;
      });
  });

  function loadToolsAdmin() {
    toolsListDiv.innerHTML = 'Loading tools...';
    db.collection('tools').get()
      .then(snapshot => {
        if (snapshot.empty) {
          toolsListDiv.innerHTML = 'No tools available.';
          return;
        }
        toolsListDiv.innerHTML = '';
        snapshot.forEach(doc => {
          const data = doc.data();
          const toolItem = document.createElement('div');
          toolItem.className = 'toolItem';
          toolItem.innerHTML = `
            <a href="${data.link}" class="toolLink" target="_blank">${data.name}</a>
            <button class="deleteBtn" data-id="${doc.id}">Delete</button>
          `;
          toolsListDiv.appendChild(toolItem);
        });

        // Attach delete event listeners
        const deleteBtns = document.querySelectorAll('.deleteBtn');
        deleteBtns.forEach(btn => {
          btn.addEventListener('click', () => {
            const id = btn.getAttribute('data-id');
            db.collection('tools').doc(id).delete()
              .then(() => loadToolsAdmin());
          });
        });
      })
      .catch(error => {
        toolsListDiv.innerHTML = `Error: ${error.message}`;
      });
  }

  addUserBtn.addEventListener('click', () => {
    const email = newUserEmailInput.value.trim();
    const password = newUserPasswordInput.value.trim();

    if(!email || !password){
      addUserMessage.style.color = '#cc3300';
      addUserMessage.textContent = 'Please enter email and password for new user.';
      return;
    }

    auth.createUserWithEmailAndPassword(email, password)
      .then(() => {
        addUserMessage.style.color = '#00bfff';
        addUserMessage.textContent = 'User added successfully!';
        newUserEmailInput.value = '';
        newUserPasswordInput.value = '';
      })
      .catch(error => {
        addUserMessage.style.color = '#cc3300';
        addUserMessage.textContent = error.message;
      });
  });

  logoutBtn.addEventListener('click', () => {
    auth.signOut().then(() => {
      adminDiv.style.display = 'none';
      loginDiv.style.display = 'block';
      loginMessage.textContent = '';
    });
  });

  logoutBtnUser.addEventListener('click', () => {
    auth.signOut().then(() => {
      userDiv.style.display = 'none';
      loginDiv.style.display = 'block';
      loginMessage.textContent = '';
    });
  });

  function loadToolsUser() {
    userToolsListDiv.innerHTML = 'Loading tools...';
    db.collection('tools').get()
      .then(snapshot => {
        if (snapshot.empty) {
          userToolsListDiv.innerHTML = 'No tools available.';
          return;
        }
        userToolsListDiv.innerHTML = '';
        snapshot.forEach(doc => {
          const data = doc.data();
          const a = document.createElement('a');
          a.href = data.link;
          a.className = 'userToolBtn';
          a.target = '_blank';
          a.textContent = data.name;
          userToolsListDiv.appendChild(a);
        });
      })
      .catch(error => {
        userToolsListDiv.innerHTML = `Error: ${error.message}`;
      });
  }

  function displayUsername(email) {
    usernameDisplay.textContent = `Welcome, ${email}`;
  }
</script>

</body>
</html>
